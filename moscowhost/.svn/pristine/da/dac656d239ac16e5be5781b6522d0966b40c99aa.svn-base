# -*-coding:utf-8 -*-
import psycopg2
import datetime
import sys
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
##############################################################################################################################################################
NOW = datetime.datetime.now().replace(day = 1)
###############################################################################
###############################################################################
###############################################################################
###############################################################################
connection_ebs = psycopg2.connect(
    host = '192.168.20.10',
    database = 'ebs',
    user = 'ebs',
    password = '1234',
    port = 5432
)
connection_ebs.set_isolation_level(1)

connection_gh = psycopg2.connect(
    host = '192.168.20.10',
    database = 'globalhome-www',
    user = 'ebs',
    password = '1234',
    port = 5432
)
connection_gh.set_isolation_level(1)

ce = connection_ebs.cursor()
cg = connection_gh.cursor()
###############################################################################
###############################################################################
###############################################################################
###############################################################################

mail_text = u"""Для подключения номера(ов) Вам необходимо выполнить следующие действия:
    1. Ознакомиться с договором и формой заказа, проверить правильность информации
    2. Распечатать и подписать 3(три) копии высланных документов
    3. Отправить подписанные документы по адресу: ул. Миклухо-Маклая, 23, Москва, Россия, 117198
-----------
С уважением,
Администрация www.globalhome.su
"""

mail_text_reserved = u"""Для бронирования номера(ов) Вам необходимо выполнить следующие действия:
    1. Ознакомиться с документами, проверить правильность информации
    2. Распечатать и подписать 3(три) копии высланных документов
    3. Отправить подписанные документы по адресу: ул. Миклухо-Маклая, 23, Москва, Россия, 117198
-----------
С уважением,
Администрация www.globalhome.su
"""

mail_text_reserved_connect = u"""Для активации забронированного(ых) номера(ов) Вам необходимо выполнить следующие действия:
    1. Ознакомиться с документами, проверить правильность информации
    2. Распечатать и подписать 3(три) копии высланных документов
    3. Отправить подписанные документы по адресу: ул. Миклухо-Маклая, 23, Москва, Россия, 117198
-----------
С уважением,
Администрация www.globalhome.su
"""

mail_text_pause = u"""Для приостановления обслуживания номера(ов) Вам необходимо выполнить следующие действия:
    1. Ознакомиться с документами, проверить правильность информации
    2. Распечатать и подписать 3(три) копии высланных документов
    3. Отправить подписанные документы по адресу: ул. Миклухо-Маклая, 23, Москва, Россия, 117198
-----------
С уважением,
Администрация www.globalhome.su
"""

mail_text_pause_connect = u"""Для восстановления обслуживания номера(ов) Вам необходимо выполнить следующие действия:
    1. Ознакомиться с документами, проверить правильность информации
    2. Распечатать и подписать 3(три) копии высланных документов
    3. Отправить подписанные документы по адресу: ул. Миклухо-Маклая, 23, Москва, Россия, 117198
-----------
С уважением,
Администрация www.globalhome.su
"""

mail_text_disconnect = u"""Для отключения номера(ов) Вам необходимо выполнить следующие действия:
    1. Ознакомиться с документами, проверить правильность информации
    2. Распечатать и подписать 3(три) копии высланных документов
    3. Отправить подписанные документы по адресу: ул. Миклухо-Маклая, 23, Москва, Россия, 117198
-----------
С уважением,
Администрация www.globalhome.su
"""

mail = (
        # { 'SUB': u'Инструкция по подключению номера 8-800', 'TEXT': mail_text, 'CODE': 'INSTRUCTION_800' },
        # { 'SUB': u'Инструкция по бронированию номера 8-800', 'TEXT': mail_text_reserved, 'CODE': 'INSTRUCTION_RESERVATION_800' },
        # { 'SUB': u'Инструкция по активации забронированного номера 8-800', 'TEXT': mail_text_reserved_connect, 'CODE': 'INSTRUCTION_RESERVATION_CONNECT_800' },
        # { 'SUB': u'Инструкция по приостановлению обслуживания номера 8-800', 'TEXT': mail_text_pause, 'CODE': 'INSTRUCTION_PAUSE_800' },
        # { 'SUB': u'Инструкция по восстановлению обслуживания номера 8-800', 'TEXT': mail_text_pause_connect, 'CODE': 'INSTRUCTION_PAUSE_CONNECT_800' },
        { 'SUB': u'Инструкция по отключению номера 8-800', 'TEXT': mail_text_disconnect, 'CODE': 'INSTRUCTION_DISCONNECT_800' },
    )

c_mail = (
        { 'SUB': u'Инструкция по подключению номера 8-800', 'TEXT': mail_text, 'CODE': 'INSTRUCTION_800' },
        { 'SUB': u'Инструкция по бронированию номера 8-800', 'TEXT': mail_text_reserved, 'CODE': 'INSTRUCTION_RESERVATION_800' },
        { 'SUB': u'Инструкция по активации забронированного номера 8-800', 'TEXT': mail_text_reserved_connect, 'CODE': 'INSTRUCTION_RESERVATION_CONNECT_800' },
        { 'SUB': u'Инструкция по приостановлению обслуживания номера 8-800', 'TEXT': mail_text_pause, 'CODE': 'INSTRUCTION_PAUSE_800' },
        { 'SUB': u'Инструкция по восстановлению обслуживания номера 8-800', 'TEXT': mail_text_pause_connect, 'CODE': 'INSTRUCTION_PAUSE_CONNECT_800' },
    )

###############################################################################
###############################################################################
###############################################################################
###############################################################################

def main():
    print '1. ADD MAIL TEXT'
    for m in mail:
        cg.execute("INSERT INTO adminmail_letter(subject, texttemplate, language_code, code) VALUES('%s', '%s', 'ru', '%s')" % (m['SUB'], m['TEXT'], m['CODE']))
    connection_gh.commit()
    print 'OK'

    print '2. CHANGE MAIL TEXT'
    for m in c_mail:
        cg.execute("UPDATE adminmail_letter SET texttemplate = '%s' WHERE code = '%s'" % (m['TEXT'], m['CODE']))
    connection_gh.commit()
    print 'OK'

###############################################################################
###############################################################################
###############################################################################
###############################################################################
if __name__ == "__main__":
    main()
